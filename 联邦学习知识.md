# Morse-STF系统
概述：使用安全多方计算（MPC）隐私方法进行机器学习的工具。
**Secure-TensorFlow**
- MORSE-STF模块是AntChain-MPC的一个子模块，是一个基于tensorflow的隐私计算系统，它可以在保护用户私有数据的前提下对多方数据进行联合计算。包括算术运算，逻辑运算，序运算等基础运算，以及基于基础运算功能之上的机器学习。

## 纵向联邦学习
一方只有特征，如 A 地区银行有用户的 姓名、月薪、身高等基本信息。
一个只有标签，如 A 地区商店有用户的 姓名、购买的商品等标签信息。
下面想两方训练一个模型，来判定身高和月薪达到什么程度，才会购买这种商品。
- 第一步，数据对齐。
- 第二步，A 模型训练，B 计算损失和梯度。
- 第三步，共享模型。

## 基础知识
两种特征：
- **单方特征：**特征向量只包含一个方向的特征。例如，在二分类问题中，每个样本只包含自变量特征，而不包括因变量特征。
- **两方特征：**特征向量同时包含两个方向的特征。例如，在二分类问题中，每个样本可以包括该样本的自变量特征和因变量特征。

两种特征具体应用的不同：
- 单方特征：L 方拥有特征，R 方拥有标签。
  - 只需在 L 方定义模型，L 方训练，R方利用标签计算损失，从而向 R 方提供梯度指导。
- 两方特征：L 方拥有0～4 的特征，R 方拥有 5～9 特征、标签。
  - 需要在 L 和 R 方都定义模型，双方都利用参数进行训练，R 方提供梯度指导。


模型参数 W 是一个变量对（每个变量是一个tensor类型）：
```python
self.w = SharedVariablePair(ownerL="L", ownerR="R", shape=[num_features, 1])

class SharedVariablePair(SharedPair):
    def __init__(self, ownerL, ownerR, xL: SharedTensorBase = None, xR: SharedTensorBase = None):
    self.xL = SharedVariable(initial_inner_value=xL.inner_value, module=xL.module)
    self.xR = SharedVariable(initial_inner_value=xR.inner_value, module=xR.module)

class SharedVariable(SharedTensor):
    def __init__(self, initial_inner_value=None, module: int = None, shape=None):
		self.inner_value = tf.Variable(initial_value=initial_inner_value % module)

```


python3 -m unittest test/test_pr.py 
python3 -m pytest test/test_pr.py 


参与 xxx 开发工作，主要负责 xxx 内容。使用 xxx 技术解决了 xxx 问题，系统提高到了 xxx。
负责 xxxx 系统，包括 xxx。

```text
	参与摩斯安全多方计算平台(Morse-MPC)的研发工作，负责将secret sharing技术与TensorFlow框架相结合，实现隐私计算在机器学习中的应用，从而实现数据的可用不可见性。
	参与摩斯隐私计算产品(Morse-STF)的研发工作，负责联邦学习模块，实现了逻辑回归、泊松回归、因子分解机等算法模型，扩展了企业数据协同计算时的各类任务和应用场景。
```

1. 密文怎么计算？
   答案：使用密码共享原理，加法和乘法的实现。从而让密文计算结果为明文。实现数据的可用不可见性。
2. 不同模型场景介绍？
   答：如下。
3. 模型具体包含的内容？
   答：**模型函数，前向和反向梯度计算函数。**这里不能使用TF或PyTorch框架提供的，变量都是定义的密文，计算中涉及到上述的算法，需要结合MPC技术手写实现。**测试模型精确度，**使用公司备用的数据集对模型进行测试，一是数据准确些验证，二是精确度的验证（能否达到要求的精度），是否需要优化。
4. 使用场景？
   答：MPC技术-政务数据安全开发。联邦学习- 联合营销、联合风控和多分联合科研等业务

模型场景介绍
- 线性回归：用于连续型因变量的预测
  - 预测房价。
- 逻辑回归：进行二分类预测
  - 预测用户购买某个产品的概率、预测银行贷款人违约风险。
- 泊松回归：计数数据的建模和预测
  - 预测一个网站每天的访问次数、预测每天发送的交通事故数量
- 因子分解机：考虑二阶特征组合的线性回归
  - 推荐系统中的用户电影评分预测问题。



因子分解机，介绍FM的背景原理。
逻辑回归，泊松回归。介绍背景原理。
STF 系统安全原理+蚂蚁链的工作内容。
纵向联邦学习。
- 蚂蚁链 stf系统的开发。指数运算
- 联邦学习



Morse-MPC（译：摩斯安全多方计算平台）：
使用的技术：秘密共享 + 混淆电路
- 秘密共享：数据和模型参数分割成两份，每个参与方持有一部分，只有当各方合作时，才能还原出原始的数据和模型参数。
- 混淆电路（乘法三元组）：支持参与方之间的安全乘法计算。

例子：
P0 和 P1 两台机器要计算 a*b。
1. 第一步，把 a 分割成两份，满足 a = a0 + a1。把 b 分割成两份，满足 b = b0 + b1。其中 a1 和 b1 是各自生成的随机数。
2. 目前  a0 、a1、b0 、b1属于 Share 变量。把 a1 与 b0 互换，得到 P0 机器拥有 a0 b0，P1 机器拥有 a1 b1。
3. 通过相关的协议计算后，P0拿到c0，P1拿到c1，而c0+c1=a*b。

这个计算过程中，只有参与方自己知道数据本身，第三方也无法获取。在最终计算结果前都属于 Share 计算，都是密文。

蚂蚁链摩斯（MORSE）隐私计算产品，基于多方安全计算、隐私保护、区块链等技术，解决企业数据协同计算过程中的数据安全和隐私保护问题，实现数据可用不可见。
目前产品广泛应用于联合营销、政务数据安全开放、联合风控、多分联合科研等业务场景。服务300+机构，在银行、保险、电信、零食、互联网等行业落地，是国内最大规模商用的隐私计算产品。

- 联合营销：每个商店都有自己的用户数据和推荐模型，商店可以共享部分用户特征和推荐模型，共同训练一个全局的推荐模型，以提高整体的推荐准确度和个性化程度。
- 联合风控：如金融机构贷款风控，即评估借款人的信用风险，可以更准确地评估借款人的信用状况，减少可能发生的违约风险。
- 政务数据安全开发：政府部门包含大量敏感数据，包括个人身份信息、财务数据等等。为了确保这些数据的安全，他们决定采用安全计算平台进行开发。

TEE：通过硬件和软件安全隔离机制来实现。
- 基于硬件的TEE使用专门的硬件模块来创建一个安全的执行环境。可以将敏感数据放置在受保护的环境中，与主处理器或操作系统分离。
- 软件TEE可以在通用处理器上运行，通过创建安全的执行环境来保护敏感数据和代码。软件TEE通常依赖于操作系统的安全性和隔离机制。

应用中的例子：
1 移动支付：当用户进行支付时，支付应用可以在TEE中运行，确保支付过程的安全和隐私保护。TEE可以防止恶意软件和操作系统的攻击，确保支付数据的机密性和完整性。
2 身份认证：TEE可以用于身份认证应用中，如指纹识别、人脸识别等。通过在TEE中运行识别算法和存储用户生物特征数据，可以保护用户的生物特征信息，防止被恶意软件和攻击者窃取和篡改。

